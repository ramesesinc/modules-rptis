import com.rameses.annotations.*

class OccupancyRptOboListInterceptor {
	
	@After(pattern="QueryService.getNodeList", eval="#{args[0]._schemaname=='occupancy_rpt_inspection'}")
	public void afterNodeList(evt) {
		def result = evt.result;
		result << [title:"Pending", state: "PENDING"]
		result << [title: "Processing", state: "PROCESSING"]
		result << [title: "Completed",  state: "COMPLETED"]
	}	

	@Before(pattern="QueryService.getList")
	public void beforeList(evt) {
		def arg = evt.args[0];
		def result = evt.result;

		def str = "state = :state";
		def m = [state: arg.node.state];
		if (arg.where) {
			arg.where[0] = str + " AND " + arg.where[0];
			arg.where[1].putAll(m);
		} else {
			arg.where = [str, m];
		}
	}
}