import com.rameses.annotations.*
import com.rameses.common.*

class RemoteActivationTask {

	@Service(value="RPTMainSyncService", connection="local-etracs-server")
	def svc;

	@Service(dynamic=true)
    def dynSvc


	@Schedule(interval=300)
	public void activateRemote(task) {
		def data = svc.getRemoteOrgData()
		data.orgs.each{org ->
			try {
				def svc = dynSvc.lookup(org.code.replaceAll('-','') + ':RemoteActivationService', 'gdx-node-script')
				return svc.activate([rootorg: data.rootorg, org: org])
			} catch(e) {
				//ignore 
			}
		}
	}

}